<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Essential Grammatical Elements of ggplot2</title>
  <meta name="description" content="Essential Grammatical Elements of ggplot2">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Essential Grammatical Elements of ggplot2" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Essential Grammatical Elements of ggplot2" />
  
  
  

<meta name="author" content="normalct">


<meta name="date" content="2018-03-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="0.0.1" data-path=""><a href="#grammar-of-graphics"><i class="fa fa-check"></i><b>0.0.1</b> Grammar of graphics</a></li>
<li class="chapter" data-level="0.0.2" data-path=""><a href="#diagram"><i class="fa fa-check"></i><b>0.0.2</b> Diagram</a></li>
<li class="chapter" data-level="0.0.3" data-path=""><a href="#ggplot2-layers"><i class="fa fa-check"></i><b>0.0.3</b> ggplot2 Layers</a></li>
<li class="chapter" data-level="0.0.4" data-path=""><a href="#introduction-to-ggplot2"><i class="fa fa-check"></i><b>0.0.4</b> Introduction to ggplot2</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essential Grammatical Elements of ggplot2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Essential Grammatical Elements of ggplot2</h1>
<h4 class="author"><em>normalct</em></h4>
<h4 class="date"><em>2018-03-18</em></h4>
</div>
<p><a href="https://youtu.be/uiTc55clwuA">Link to the ggplot2 tutorial: Grammar of graphics</a></p>
<div id="grammar-of-graphics" class="section level3">
<h3><span class="header-section-number">0.0.1</span> Grammar of graphics</h3>
<ul>
<li>Building blocks</li>
<li>For solid, creative, meaningful visualizations</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Element</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Data</td>
<td>The data being plotted.</td>
</tr>
<tr class="even">
<td>Aesthetics</td>
<td>The scales onto which we map our data.</td>
</tr>
<tr class="odd">
<td>Geometrics</td>
<td>The visual elements used for our data.</td>
</tr>
<tr class="even">
<td>Facets</td>
<td>Plotting small elements.</td>
</tr>
<tr class="odd">
<td>Statistics</td>
<td>Representation of our data to aid understanding.</td>
</tr>
<tr class="even">
<td>Coordinates</td>
<td>The space on which the data will be plotted.</td>
</tr>
<tr class="odd">
<td>Themes</td>
<td>All non-data ink.</td>
</tr>
</tbody>
</table>
</div>
<div id="diagram" class="section level3">
<h3><span class="header-section-number">0.0.2</span> Diagram</h3>
<table>
<thead>
<tr class="header">
<th align="left">Data</th>
<th align="center"><em>{variables of interest}</em></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Aesthetics</td>
<td align="center">x-axis</td>
<td align="center">colour</td>
<td align="center">size</td>
<td align="center">alpha</td>
</tr>
<tr class="even">
<td align="left">.</td>
<td align="center">y-axis</td>
<td align="center">fill</td>
<td align="center">labels</td>
<td align="center">shape</td>
</tr>
<tr class="odd">
<td align="left">Geometries</td>
<td align="center">point</td>
<td align="center">line</td>
<td align="center">histogram</td>
<td align="center">bar</td>
</tr>
<tr class="even">
<td align="left">Facets</td>
<td align="center">columns</td>
<td align="center">rows</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Statistics</td>
<td align="center">binning</td>
<td align="center">smoothing</td>
<td align="center">descriptive</td>
<td align="center">inferential</td>
</tr>
<tr class="even">
<td align="left">Coordinates</td>
<td align="center">cartesian</td>
<td align="center">fixed</td>
<td align="center">polar</td>
<td align="center">limits</td>
</tr>
<tr class="odd">
<td align="left">Themes</td>
<td align="center">non-data ink</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
</div>
<div id="ggplot2-layers" class="section level3">
<h3><span class="header-section-number">0.0.3</span> ggplot2 Layers</h3>
<div id="data" class="section level4">
<h4><span class="header-section-number">0.0.3.1</span> 1. Data</h4>
<p>Obviously, the first layer is data. Example data: Iris dataset - by Edgar Anderson, popularized by R.A. Fisher. - 3 species of irises: setosa, versicolor, virginica. - 4 measurements were made: sepal length and width, petal length and width.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(iris)</code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  Setosa
## 2          4.9         3.0          1.4         0.2  Setosa
## 3          4.7         3.2          1.3         0.2  Setosa
## 4          4.6         3.1          1.5         0.2  Setosa
## 5          5.0         3.6          1.4         0.2  Setosa
## 6          5.4         3.9          1.7         0.4  Setosa</code></pre>
</div>
<div id="aesthetics" class="section level4">
<h4><span class="header-section-number">0.0.3.2</span> 2. Aesthetics</h4>
<p>Second layer is Aesthetics which tells us which scale we shall map our data onto. This is the second main component of the grammar of graphics comes into play. On top of the grammatical elements, it’s here that we establish our static mappings.</p>
<p>In this Iris example, we are going to make a statterplot, so we’re going to map the Sepal.Length to the x aesthetic, and Sepal.Width to the y aesthetic.</p>
<table>
<thead>
<tr class="header">
<th>Species</th>
<th>Sepal.Length</th>
<th>Sepal.Width</th>
<th>Petal.Length</th>
<th>Petal.Width</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>.</td>
<td>X</td>
<td>Y</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="geometries" class="section level4">
<h4><span class="header-section-number">0.0.3.3</span> 3. Geometries</h4>
<p>The third layer allows us to choose geometry. That means, how the plot will look.</p>
<p>After we’ve established our three essential layers, we have enough instructions to make a basic scatterplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)
iris <span class="op">%&gt;%</span>
<span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width) ) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.png" width="288" /></p>
<p>It’s pretty rough. To get a more meaningful and cleaner visualization, we’ll have to use other layers.</p>
</div>
<div id="facets" class="section level4">
<h4><span class="header-section-number">0.0.3.4</span> 4. Facets</h4>
<p>The next layer we’ll use is the Facets, which dictates how to split up our plot. In this case, we want to make three separate plots, one for each of the three species under consideration.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span>
<span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width) ) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Species)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="statistics" class="section level4">
<h4><span class="header-section-number">0.0.3.5</span> 5. Statistics</h4>
<p>The Statistics layer can be used to calculate and add many different parameters. For example, here we’ve chosen to add a linear model to each of the three subplots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span>
<span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width) ) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Species) <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span> )</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="coordinates" class="section level4">
<h4><span class="header-section-number">0.0.3.6</span> 6. Coordinates</h4>
<p>Next comes the Coordinates layer which allows us to specify the precise dimensions of the plot. Here, we’ve also cleaned up the labeling and the scaling of both the x and y axes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(iris<span class="op">$</span>Species) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Setosa&quot;</span>, <span class="st">&quot;Versicolor&quot;</span>, <span class="st">&quot;Virginica&quot;</span>)
iris <span class="op">%&gt;%</span>
<span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width) ) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Species) <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span> ) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Sepal Width (cm)&quot;</span>,
                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>),
                       <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;Sepal Length (cm)&quot;</span>,
                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">8</span>),
                       <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_equal</span>()</code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="theme" class="section level4">
<h4><span class="header-section-number">0.0.3.7</span> 7. Theme</h4>
<p>Finally, the Theme layer controls all the non-data ink on our plot, which allows us to get a nice-looking and meaningful and publication-quality plot directly in arm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(iris<span class="op">$</span>Species) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Setosa&quot;</span>, <span class="st">&quot;Versicolor&quot;</span>, <span class="st">&quot;Virginica&quot;</span>)
<span class="kw">library</span>(grid)
iris <span class="op">%&gt;%</span>
<span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width) ) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Species) <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span> ) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Sepal Width (cm)&quot;</span>,
                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>),
                       <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;Sepal Length (cm)&quot;</span>,
                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">8</span>),
                       <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
          <span class="dt">plot.background =</span> <span class="kw">element_blank</span>(),
          <span class="dt">legend.background =</span> <span class="kw">element_blank</span>(),
          <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),
          <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>),
          <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),
          <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),
          <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
          <span class="dt">strip.text =</span> <span class="kw">element_blank</span>(),
          <span class="dt">panel.spacing=</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>)
    )</code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>

</div>
<div id="datacamp-youtube-link" class="section level4">
<h4><span class="header-section-number">0.0.3.8</span> <a href="https://youtu.be/YxKr2a-Y1WE">DataCamp Youtube Link</a></h4>
</div>
</div>
<div id="introduction-to-ggplot2" class="section level3">
<h3><span class="header-section-number">0.0.4</span> Introduction to ggplot2</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)
### mammal data <span class="al">###</span>
<span class="co"># head(mammals)</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># first attempt to plot</span>
mammals <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x=</span>body, <span class="dt">y=</span>brain)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fine tuning:</span>
<span class="co"># The above plot shows that there are two points that might be</span>
<span class="co"># outliers that excerts huge influence.</span>
<span class="co"># We might need to use the log transformation</span>

mammals <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>body, <span class="dt">y=</span>brain)) <span class="op">+</span>
<span class="st">    </span><span class="kw">annotation_logticks</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_log10</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_log10</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,  <span class="dt">col =</span> <span class="st">&quot;#C42126&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">size=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Further fine tuning</span>
mammals <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x=</span>body, <span class="dt">y=</span>brain) ) <span class="op">+</span>
<span class="st">    </span><span class="kw">annotation_logticks</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_fixed</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">4</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">4</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_log10</span>( <span class="kw">expression</span>(<span class="st">&quot;Body weight (log&quot;</span>[<span class="st">&quot;10&quot;</span>]<span class="op">*</span><span class="st">&quot;(Kg))&quot;</span>,
                             <span class="dt">breaks =</span> <span class="kw">trans_breaks</span>(<span class="st">&quot;log10&quot;</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="op">^</span>x),
                             <span class="dt">labels =</span> <span class="kw">trans_format</span>(<span class="st">&quot;log10&quot;</span>, <span class="kw">math_format</span>(<span class="dv">10</span><span class="op">^</span>.x)) )) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_log10</span>( <span class="kw">expression</span>(<span class="st">&quot;Brain weight (log&quot;</span>[<span class="st">&quot;10&quot;</span>]<span class="op">*</span><span class="st">&quot;(Kg))&quot;</span>,
                   <span class="dt">breaks =</span> <span class="kw">trans_breaks</span>(<span class="st">&quot;log10&quot;</span>, <span class="cf">function</span>(y) <span class="dv">10</span><span class="op">^</span>x),
                   <span class="dt">labels =</span> <span class="kw">trans_format</span>(<span class="st">&quot;log10&quot;</span>, <span class="kw">math_format</span>(<span class="dv">10</span><span class="op">^</span>.x)) )
    ) <span class="op">+</span>
<span class="st">    </span><span class="co"># stat_smooth(method = &quot;lm&quot;, col = &quot;#C42126&quot;, se = TRUE, size=1)</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;#C42126&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Anscombe data <span class="al">###</span>
<span class="co"># head(anscombe)</span>

anscombe <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x1, <span class="dt">y=</span>y1)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">anscombe <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x2, <span class="dt">y=</span>y2)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">anscombe <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x3, <span class="dt">y=</span>y3)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">anscombe <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x4, <span class="dt">y=</span>y4)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-4.png" width="672" /></p>

</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
